<!DOCTYPE html>

<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&family=DM+Mono:ital,wght@0,300;0,400;0,500;1,300;1,400;1,500&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/styles.css') }}"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
      crossorigin="anonymous"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <title>{% block title %}{% endblock %}</title>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarToggler" aria-controls="navbarTogglerDemo02" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div id="navbarToggler" class="collapse navbar-collapse">
        <a class="navbar-brand">
          Remini<span>Dex</span>
        </a>
        {% if session["user_id"] %}

        <ul class="navbar-nav nav-right pe-3 ms-auto mt-2">
          <li class="nav-item">
            <a class="nav-link" href="/"
              ><i class="bi bi-house-door-fill"></i> Home</a
            >
          </li>
          <li class="nav-item dropdown-center" id="create_button">
            <div
              class="nav-link"
              role="button"
              data-bs-toggle="dropdown"
              aria-expanded="false"
            >
              <i class="bi bi-plus-circle-fill"></i>
              Create
            </div>

            <ul id="create_dropdown" class="dropdown-menu p-0">
              <li>
                <a
                  class="text-primary dropdown-item rounded-top"
                  href="{{ url_for('create_list', list=None) }}"
                  ><i class="text-primary bi bi-collection"></i> List</a
                >
              </li>
              <li><hr class="dropdown-divider m-0" /></li>
              <li>
                <div
                  class="text-primary dropdown-item rounded-bottom"
                  data-bs-toggle="modal"
                  data-bs-target="#createFolderModal"
                >
                  <i class="text-primary fa-regular fa-folder-closed"></i>
                  Folder
                </div>
              </li>
            </ul>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/account"
              ><i class="bi bi-person-circle"></i> {{username}}</a
            >
          </li>
          <li class="nav-item theme-switcher">
            <i class="nav-link bi bi-moon"></i>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/logout"
              ><i class="fa-solid fa-arrow-right-from-bracket"></i
            > Logout</a>
          </li>
        </ul>
        {% else %}

        <ul class="navbar-nav nav-right pe-3 ms-auto mt-2">
          <li class="nav-item theme-switcher">
            <i class="nav-link bi bi-moon"></i>
          </li>
          <li class="nav-item"><a class="nav-link" href="/login">Log in</a></li>
          <li class="nav-item btn btn-light">
            <a class="text-decoration-none text-primary" href="/register"
              >Register</a
            >
          </li>
        </ul>

        {% endif %}
      </div>

    </nav>

    <div class="main">{% block main %} {% endblock %}</div>

    <div
      class="modal fade"
      id="createFolderModal"
      aria-labelledby="createFolderModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">
              <i class="text-primary bi bi-folder2"></i> Create folder
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form action="/create_folder" method="post">
              <input
                type="text"
                name="name"
                class="form-control my-5"
                placeholder="Choose a name for your folder"
              />
              <div class="modal-footer">
                <button
                  type="button"
                  class="btn btn-secondary"
                  data-bs-dismiss="modal"
                >
                  Cancel
                </button>
                <input type="submit" class="btn btn-primary" value="Create" />
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <div aria-live="polite" aria-atomic="true" class="position-relative">
      <div class="toast-container pt-4 position-fixed top-0 end-0 p-3">
        {% with messages = get_flashed_messages(with_categories=true) %} {% if
        messages %} {% for category, message in messages %}
        <div
          class="toast mt-5 align-items-center text-bg-{{ category }} border-0"
          role="alert"
          aria-live="assertive"
          aria-atomic="true"
        >
          <div class="d-flex">
            <div class="toast-body">{{ message }}</div>
            <button
              type="button"
              class="btn-close btn-close-white me-2 m-auto"
              data-bs-dismiss="toast"
              aria-label="Close"
            ></button>
          </div>
        </div>
        {% endfor %} {% endif %} {% endwith %}
      </div>
    </div>
  </body>

  {% block script %} {% endblock %}

  <script>
    /**
  * Overall settings
  * Handles app theme and toasters.
  */

    let storage = window.localStorage;

    let theme = "light";

    if (storage.theme) {
      theme = storage.theme;
    }

    const body = document.querySelector("body");
    const themeSwitcher = document.querySelector(".theme-switcher");

    // Alter the DOM according to the selected theme and store the theme's value into local storage

    themeSwitcher.addEventListener("click", () => {
      if (theme == "light") {
        theme = "dark";
        themeSwitcher.innerHTML = `<i class="nav-link bi bi-brightness-high"></i>`;
        body.classList.add("dark");
        body.classList.remove("light");
        document.querySelectorAll(".btn-close").forEach(btn => btn.classList.add("btn-close-white"))
        document.querySelectorAll(".bg-light").forEach(div => div.classList.replace("bg-light", "bg-secondary"))
      } else {
        theme = "light";
        themeSwitcher.innerHTML = `<i class="nav-link bi bi-moon"></i>`;
        body.classList.remove("dark");
        body.classList.add("light");
        document.querySelectorAll(".btn-close").forEach(btn => btn.classList.remove("btn-close-white"))
        document.querySelectorAll(".bg-secondary").forEach(div => div.classList.replace("bg-secondary", "bg-light"))
      }

      storage.setItem("theme", theme);
    });

    document.addEventListener("DOMContentLoaded", function () {
      if (window.localStorage.theme) {
        theme = window.localStorage.theme;
      }

      body.classList.add(theme);

      var toastElList = [].slice.call(document.querySelectorAll(".toast"));
      toastElList.forEach(function (toastEl) {
        var toast = new bootstrap.Toast(toastEl);
        toast.show();
      });
    });
  </script>
</html>
